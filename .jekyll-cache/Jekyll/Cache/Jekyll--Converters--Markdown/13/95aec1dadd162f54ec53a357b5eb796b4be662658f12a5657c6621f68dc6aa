I"©<h3 id="react-addeventlistener">react addEventListener</h3>

<ul>
  <li>reactì—ì„œ input íƒœê·¸ë¥¼ ì‚¬ìš©í•˜ì—¬ íŒŒì¼ ë“œë˜ê·¸ì•¤ë“œë¡­ì„ êµ¬í˜„í•œë‹¤ê³  í–ˆì„ë•Œ ë‹¤ìŒê³¼ ê°™ì´ ì‘ì„±í•  ìˆ˜ ìˆë‹¤.</li>
</ul>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">dragRef</span> <span class="o">=</span> <span class="p">(</span><span class="nx">useRef</span> <span class="o">&lt;</span> <span class="nx">HTMLDivElement</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="kc">null</span> <span class="o">&gt;</span> <span class="kc">null</span><span class="p">);</span>
<span class="kd">const</span> <span class="p">[</span><span class="nx">files</span><span class="p">,</span> <span class="nx">setFiles</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">([]);</span>

<span class="kd">const</span> <span class="nx">addFile</span> <span class="o">=</span> <span class="p">(</span><span class="nx">e</span><span class="p">:</span> <span class="nx">ChangeEvent</span><span class="o">&lt;</span><span class="nx">HTMLInputElement</span><span class="o">&gt;</span> <span class="o">|</span> <span class="nx">any</span><span class="p">):</span> <span class="k">void</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="na">newFiles</span><span class="p">:</span> <span class="nx">File</span><span class="p">[]</span> <span class="o">=</span> <span class="nb">Array</span><span class="p">.</span><span class="k">from</span><span class="p">(</span>
    <span class="nx">e</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="dl">"</span><span class="s2">drop</span><span class="dl">"</span> <span class="p">?</span> <span class="nx">e</span><span class="p">.</span><span class="nx">dataTransfer</span><span class="p">.</span><span class="nx">files</span> <span class="p">:</span> <span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">files</span>
  <span class="p">);</span>

  <span class="nx">setFiles</span><span class="p">([...</span><span class="nx">files</span><span class="p">,</span> <span class="nx">newFiles</span><span class="p">]);</span>
<span class="p">};</span>

<span class="kd">const</span> <span class="nx">handleDrop</span> <span class="o">=</span> <span class="p">(</span><span class="na">e</span><span class="p">:</span> <span class="nx">DragEvent</span><span class="p">):</span> <span class="k">void</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">addFile</span><span class="p">(</span><span class="nx">e</span><span class="p">);</span>
<span class="p">};</span>

<span class="kd">const</span> <span class="nx">initDragEvent</span> <span class="o">=</span> <span class="p">():</span> <span class="k">void</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">dragRef</span><span class="p">.</span><span class="nx">current</span><span class="p">.</span><span class="nx">addEventlistener</span><span class="p">(</span><span class="dl">"</span><span class="s2">drag</span><span class="dl">"</span><span class="p">,</span> <span class="nx">handleDrop</span><span class="p">);</span>
<span class="p">};</span>

<span class="nx">useEffect</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">initDragEvent</span><span class="p">();</span>
<span class="p">},</span> <span class="p">[]);</span>

<span class="o">&lt;</span><span class="nx">div</span> <span class="nx">ref</span><span class="o">=</span><span class="p">{</span><span class="nx">dragRef</span><span class="p">}</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="dl">"</span><span class="s2">file</span><span class="dl">"</span> <span class="nx">accept</span><span class="o">=</span><span class="p">{</span><span class="dl">"</span><span class="s2">.jpg,.txt</span><span class="dl">"</span><span class="p">}</span> <span class="nx">multiple</span> <span class="nx">onChange</span><span class="o">=</span><span class="p">{</span><span class="nx">onChangeFiles</span><span class="p">}</span> <span class="sr">/</span><span class="err">&gt;
</span><span class="o">&lt;</span><span class="sr">/div&gt;</span><span class="err">;
</span></code></pre></div></div>

<ul>
  <li>ì´ë ‡ê²Œ í–ˆì„ë•Œ, addFile ì•ˆì— filesëŠ” ì–´ë–»ê²Œ ë‚˜ì˜¬ê¹Œ?</li>
  <li>ì²«ë²ˆì§¸ file ë“œë¡­í• ë•ŒëŠ”, ë¬¸ì œ ì—†ë‹¤.</li>
  <li>í•˜ì§€ë§Œ, ë‘ë²ˆì§¸ file ë“œë¡­í• ë•ŒëŠ” filesëŠ” ì²«ë²ˆì§¸ì— ì¶”ê°€ëœ fileì´ ë³´ì´ì§€ ì•ŠëŠ”ë‹¤â€¦</li>
</ul>

<h4 id="ì´ìœ ëŠ”">ì´ìœ ëŠ”?</h4>

<ul>
  <li>files ëŠ” ê³¼ê±°ì˜ valueë¥¼ ê°€ì§€ê³  ìˆë‹¤. ì´ìœ ëŠ”</li>
  <li>ì»´í¬ë„ŒíŠ¸ ë§ˆìš´íŠ¸(useEffect)í•˜ë©´ì„œ ë“±ë¡ëœ handleDropì€ refë¡œ ê°€ì ¸ì˜¨ React componentê°€ ì•„ë‹Œ, ì‹¤ì œ html element eventë¡œ ë“±ë¡ì´ ë˜ì—ˆë‹¤.</li>
  <li>ì²«ë²ˆì§¸ file drop í›„, ë¦¬ë Œë” ë ë•ŒëŠ” ìƒˆë¡œìš´ ë©”ì†Œë“œê°€ handleDropì— í• ë‹¹ë˜ì§€ë§Œ, ì—¬ì „íˆ, dragRef.current â€˜dragâ€™ ì´ë²¤íŠ¸ì—ëŠ” ê¸°ì¡´ ë©”ì†Œë“œê°€ ë“±ë¡ë˜ì–´ìˆëŠ” ìƒíƒœì´ë‹¤.</li>
  <li>ê·¸ëŸ¬ë¯€ë¡œ, ê³„ì† old filesë¥¼ ë°”ë¼ë³´ê³  ìˆê²Œëœë‹¤.</li>
  <li>ì´ ë¬¸ì œë¥¼ í•´ê²°í•˜ë ¤ë©´, rerender ë ë•Œë§ˆë‹¤, ê¸°ì¡´ ë“±ë¡ëœ event listenerë¥¼ ì œê±°í•˜ê³ , ìƒˆë¡œ ìƒê¸´ event listenerë¥¼ ë“±ë¡í•´ì£¼ê±°ë‚˜,</li>
  <li>
    <p>useRefë¥¼ ì‚¬ìš©í•˜ì—¬, í•´ê²°ê°€ëŠ¥í•˜ë‹¤.</p>
  </li>
  <li>ì°¸ê³  : https://stackoverflow.com/questions/55265255/react-usestate-hook-event-handler-using-initial-state</li>
</ul>
:ET